@startuml
title Authorizing a Security System Disarm

participant "Client" as C

box "Security System Service"
  participant "SecuritySystemServiceImpl" as SSS
  participant "OsoSecuritySystemActionAuthorizer" as Auth
end box

participant "Oso Cloud" as OSO

C -> SSS : disarm(securitySystemId)
SSS -> Auth : isAllowed("disarm", securitySystemId)
Auth -> OSO : oso.authorize(\n  CustomerEmployee{userId},\n  "disarm",\n  SecuritySystem{securitySystemId})
OSO --> Auth : true / false
alt authorized
  SSS -> SSS : securitySystem.disarm()
  SSS --> C : SecuritySystem (DISARMED)
else not authorized
  Auth --> C : 403 Forbidden
end

@enduml
